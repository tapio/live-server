<!-- Code injected by live-server -->
<script type="text/javascript">
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function() {
			function refreshCSS(file) {
				var timestamp = new Date().getTime();
				document.head.insertAdjacentHTML('beforeend', `<link rel="stylesheet" href="${file}" class="cache_${timestamp}">`);
				document.querySelectorAll(`link[href="${file}"]`).forEach(function(e) {
					if (!!~e.href.indexOf(file) && e.className !== 'cache_' + timestamp) {
						setTimeout(function(){e.remove()}, 300);
					}
				});
			}

			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function(msg) {
				var cmd = msg.data.split(':')[0];
				var arg = msg.data.split(':')[1];
				if (cmd == 'reload') window.location.reload();
				else if (cmd == 'refreshcss') refreshCSS(arg);
			};
			console.log('Live reload enabled.');
		})();
	}
	// ]]>
</script>
